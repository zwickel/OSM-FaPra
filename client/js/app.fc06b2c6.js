(function(e){function t(t){for(var n,i,s=t[0],l=t[1],c=t[2],u=0,p=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);d&&d(t);while(p.length)p.shift()();return a.push.apply(a,c||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,s=1;s<r.length;s++){var l=r[s];0!==o[l]&&(n=!1)}n&&(a.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},o={app:0},a=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var d=l;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"0e25":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);var n=r("2b0e"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",[r("v-app-bar",{attrs:{id:"toolbar",app:"",dark:""}},[r("v-toolbar-title",{staticClass:"headline text-uppercase"},[r("span",[e._v("OpenStreetMap")]),r("v-spacer"),r("span",{staticClass:"font-weight-light"},[e._v("Meeting point finder")])],1),r("v-spacer"),r("v-btn",{attrs:{text:""}},[r("span",{staticClass:"mr-2"},[e._v("Latest Release")])])],1),r("v-content",[r("Map")],1)],1)},a=[],i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{staticClass:"pa-2",attrs:{fluid:""}},[r("v-row",{attrs:{"no-gutters":""}},[r("v-col",[r("v-card",{attrs:{height:"100%"}},[r("div",{attrs:{id:"map"}},[r("Popup")],1)])],1),r("v-col",{attrs:{md:2}},[r("Positions",{attrs:{positions:e.startPositions,gettingCenter:e.gettingCenter},on:{removePos:e.onRemovePos,getCenter:e.getPathsFromDijkstra,clearMap:e.onClearMap}})],1)],1)],1)},s=[],l=r("bc3a"),c=r.n(l),d=(r("5bc0"),r("5eee")),u=r("a2c7"),p=r("480c"),h=r("d0e9"),g=r("3e6b"),v=r("5831"),f=r("256f"),m=r("4cdf"),w=r("f403"),y=r("7a09"),b=r("6c77"),k=r("8295"),P=r("83a6"),S=r("8682"),_=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},C=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{attrs:{id:"popup"}})])}],M=r("0710"),x={name:"Popup",data(){return{popup:null}},mounted(){this.popup=new M["a"]({element:document.getElementById("popup")})}},j=x,O=r("2877"),V=Object(O["a"])(j,_,C,!1,null,null,null),E=V.exports,I=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",{attrs:{id:"list-container",dark:""}},[r("v-card-title",{attrs:{id:"list-container-title"}},[e._v("Positions")]),r("v-card-text",{staticClass:"scroll",attrs:{id:"list-of-positions"}},[0==e.positions.length?r("span"):e._e(),e._l(e.positions,(function(t,n){return r("v-card",{key:n,attrs:{elevation:22}},[r("v-card-title",[r("div",[e._v("Position "+e._s(n))]),r("v-btn",{attrs:{absolute:"",right:"",icon:"",color:"orange"},on:{click:function(t){return e.$emit("removePos",n)}}},[r("v-icon",[e._v("mdi-close")])],1)],1),r("v-card-text",[e._v("\n        lat: "+e._s(t.coords.lat)+"\n        "),r("br"),e._v("\n        lon: "+e._s(t.coords.lon)+"\n      ")])],1)}))],2),r("v-card-actions",{attrs:{id:"list-container-actions"}},[r("v-btn",{attrs:{loading:e.gettingCenter},on:{click:function(t){return e.$emit("getCenter")}}},[e._v("Find Meeting Point")]),r("v-btn",{on:{click:function(t){return e.$emit("clearMap")}}},[e._v("Clear Map")])],1)],1)},F=[],B={name:"Positions",props:["positions","gettingCenter"],data(){return{}},mounted(){document.getElementById("list-container").style.height=window.innerHeight-document.getElementById("toolbar").clientHeight-20+"px",document.getElementById("list-of-positions").style.height=document.getElementById("list-container").clientHeight-document.getElementById("list-container-title").clientHeight-document.getElementById("list-container-actions").clientHeight+"px"},methods:{},computed:{}},N=B,L=(r("7d08"),r("6544")),$=r.n(L),T=r("8336"),A=r("b0af"),H=r("99d9"),D=r("132d"),R=Object(O["a"])(N,I,F,!1,null,null,null),U=R.exports;$()(R,{VBtn:T["a"],VCard:A["a"],VCardActions:H["a"],VCardText:H["b"],VCardTitle:H["c"],VIcon:D["a"]});var z={name:"Map",components:{Popup:E,Positions:U},data(){return{map:null,markerSource:null,markerLayer:null,startMarkerStyle:null,goalMarkerStyle:null,edgeSource:null,edgeLayer:null,edgeStyle:null,sourceProjection:"EPSG:4326",targetProjection:"EPSG:3857",infoClick:null,startPositions:[],goalPosition:null,gettingCenter:!1}},mounted(){this.initMap()},methods:{initMap(){this.map=new d["a"]({target:"map",layers:[new p["a"]({source:new h["a"]})],view:new u["a"]({center:Object(f["i"])([10,51],this.sourceProjection,this.targetProjection),zoom:6})}),this.markerSource=new v["a"]({features:[]}),this.markerLayer=new g["a"]({source:this.markerSource,zIndex:1001}),this.map.addLayer(this.markerLayer),this.startMarkerStyle=new b["b"]({text:new k["a"]({text:"",font:"normal 25px FontAwesome",fill:new P["a"]({color:"red"}),offsetY:-12})}),this.goalMarkerStyle=new b["b"]({text:new k["a"]({text:"",font:"normal 35px FontAwesome",fill:new P["a"]({color:"#0ff207"}),stroke:new S["a"]({color:"black"}),offsetY:-17})}),this.edgeSource=new v["a"]({}),this.edgesLayer=new g["a"]({source:this.edgeSource,zIndex:1e3}),this.map.addLayer(this.edgesLayer),this.edgeStyle=new b["b"]({stroke:new S["a"]({width:6,color:"orange"})});var e=this;this.map.on("singleclick",(function(t){e.infoClick=Object(f["h"])(t.coordinate),e.getNearestNode(e.infoClick,"start")}))},getNearestNode(e,t){var r=this;c()({method:"post",url:window.serverUrl+"getnearestnode",data:'{"lon": '+e[0]+', "lat": '+e[1]+"}"}).then(e=>{console.log("nearestNode response: ",e.data),r.addNewMarker(e.data,t)}).catch(e=>{console.error(e)})},addNewMarker(e,t){let r=[e.coords.lon,e.coords.lat];var n=new m["a"]({type:"geoMarker",geometry:new w["a"](Object(f["d"])(r)),name:"marker"+this.markerSource.getFeatures().length}),o=this.markerSource.getFeatures().length;n.setId(o),"goal"==t?n.setStyle(this.goalMarkerStyle):n.setStyle(this.startMarkerStyle),console.log("features: "+this.markerSource.getFeatures().length),this.markerSource.addFeature(n),e.featureId=o,"goal"==t?this.goalPosition=e:(e.weight=1,this.startPositions.push(e))},onRemovePos(e){var t=this.startPositions[e].featureId;this.markerSource.removeFeature(this.markerSource.getFeatureById(t)),this.startPositions.splice(e,1)},onGetCenter(){this.gettingCenter=!0;var e=0,t=0,r=0;this.startPositions.forEach(n=>{e+=n.coords.lat*n.weight,t+=n.coords.lon*n.weight,r+=n.weight}),e/=r,t/=r;var n=[t,e];this.getNearestNode(n,"goal")},getPathsFromDijkstra(){var e="{";for(var t in this.startPositions)e+='"id'+t+'": '+this.startPositions[t].id+", ";e=e.substring(0,e.length-2)+"}";var r=this;c()({method:"POST",url:window.serverUrl+"getpaths",data:e}).then(e=>{console.log(e.data),r.showCenter(e.data.center),r.showPaths(e.data.paths)}).catch(e=>{console.error(e)})},showCenter(e){this.addNewMarker(e,"goal")},showPaths(e){for(var t in e){var r=[];for(var n in e[t])r.push(Object(f["d"])([e[t][n].lon,e[t][n].lat]));var o=new m["a"]({type:"edge",geometry:new y["a"](r),name:"path"});o.setStyle(this.edgeStyle),this.edgeSource.addFeature(o)}this.gettingCenter=!1},onClearMap(){this.startPositions=[],this.markerSource.clear(),this.edgeSource.clear()}}},G=z,J=(r("bfe4"),r("62ad")),Y=r("a523"),q=r("0fd9"),K=Object(O["a"])(G,i,s,!1,null,"acfd4728",null),Q=K.exports;$()(K,{VCard:A["a"],VCol:J["a"],VContainer:Y["a"],VRow:q["a"]});var W={name:"App",components:{Map:Q},data:()=>({})},X=W,Z=r("7496"),ee=r("40dc"),te=r("a75b"),re=r("2fa4"),ne=r("2a7f"),oe=Object(O["a"])(X,o,a,!1,null,null,null),ae=oe.exports;$()(oe,{VApp:Z["a"],VAppBar:ee["a"],VBtn:T["a"],VContent:te["a"],VSpacer:re["a"],VToolbarTitle:ne["a"]});var ie=r("2f62"),se={},le={},ce={};n["a"].use(ie["a"]);var de=new ie["a"].Store({state:{},getters:se,mutations:le,actions:ce}),ue=r("f309");n["a"].use(ue["a"]);var pe=new ue["a"]({icons:{iconfont:"mdi"}});n["a"].config.productionTip=!1,window.vueDevMode="production",window.serverUrl=location.protocol+"//"+location.host+location.pathname,"development"===window.vueDevMode&&(window.serverUrl=location.protocol+"//localhost:8091/"),new n["a"]({store:de,vuetify:pe,render:e=>e(ae)}).$mount("#app")},"7d08":function(e,t,r){"use strict";var n=r("0e25"),o=r.n(n);o.a},bfe4:function(e,t,r){"use strict";var n=r("d527"),o=r.n(n);o.a},d527:function(e,t,r){}});
//# sourceMappingURL=app.fc06b2c6.js.map